# MVP開発タスクリスト

## Phase 1: 環境構築

### 1.1 Supabase セットアップ
- [ ] Supabaseプロジェクト作成
- [ ] Google OAuth設定（カレンダー権限付き）
- [ ] データベーステーブル作成
  - [ ] `users` テーブル
  - [ ] `friendships` テーブル
  - [ ] `chat_messages` テーブル
- [ ] RLS（Row Level Security）ポリシー設定

### 1.2 プロジェクト構成
- [ ] フォルダ構成の整理
- [ ] Supabase Client導入（`@supabase/supabase-js`）
- [ ] 環境変数の設定（`.env.local`）
- [ ] Vercelプロジェクト作成・連携

---

## Phase 2: 認証機能

### 2.1 ログイン/ログアウト
- [ ] Googleログインボタン実装
- [ ] ログイン後のリダイレクト処理
- [ ] ログアウト機能
- [ ] 認証状態の管理（Context or Zustand）

### 2.2 ユーザープロフィール
- [ ] 初回ログイン時に`users`テーブルへ登録
- [ ] プロフィール情報の取得・表示
- [ ] Googleトークン（refresh_token）の保存

---

## Phase 3: Googleカレンダー連携

### 3.1 カレンダーAPI連携
- [ ] Google Calendar API有効化（GCP Console）
- [ ] アクセストークン取得・リフレッシュ処理
- [ ] 自分の予定取得API実装（Edge Function）
- [ ] フレンドの予定取得API実装

### 3.2 空き時間計算
- [ ] 単一ユーザーの空き時間算出ロジック
- [ ] 複数ユーザーの共通空き時間算出ロジック

---

## Phase 4: フレンド機能

### 4.1 フレンド管理
- [ ] ユーザー検索機能（メールアドレス or 表示名）
- [ ] フレンドリクエスト送信
- [ ] フレンドリクエスト承認/拒否
- [ ] フレンド一覧表示
- [ ] フレンド削除

### 4.2 UI
- [ ] フレンド一覧コンポーネント（サイドバー）
- [ ] フレンド追加モーダル
- [ ] リクエスト通知バッジ

---

## Phase 5: チャット機能

### 5.1 AIチャット
- [ ] 既存のGemini連携をSupabase対応に改修
- [ ] @メンション機能（フレンド指定）
- [ ] カレンダーデータをAIに渡す処理
- [ ] AIレスポンスのストリーミング（任意）

### 5.2 チャット履歴
- [ ] メッセージ保存処理
- [ ] 履歴読み込み処理
- [ ] 履歴のページネーション（任意）

### 5.3 UI改修
- [ ] ログイン状態に応じた表示切替
- [ ] サイドバーにフレンド一覧表示
- [ ] @メンションのオートコンプリート

---

## Phase 6: デプロイ・テスト

### 6.1 Vercelデプロイ
- [ ] 環境変数設定（Vercel Dashboard）
- [ ] ビルド・デプロイ確認
- [ ] カスタムドメイン設定（任意）

### 6.2 テスト
- [ ] ログインフロー確認
- [ ] カレンダー取得確認
- [ ] フレンド機能確認
- [ ] 空き時間検索確認

---

## 補足: 技術的な検討事項

| 項目 | 選択肢 | 決定 |
|------|--------|------|
| 状態管理 | React Context / Zustand / Jotai | 未定 |
| スタイリング | Tailwind（現状） | 確定 |
| フォーム | React Hook Form / 素のReact | 未定 |
| APIコール | fetch / TanStack Query | 未定 |

---

## 優先度の目安

```
高: Phase 1 → Phase 2 → Phase 3
中: Phase 5（チャット）
低: Phase 4（フレンド）※ 最初は自分のカレンダーのみでもOK
```

---

*最終更新: 2026-02-05*
